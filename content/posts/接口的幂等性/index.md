---
title: "接口的幂等性"
date: 2023-05-29T17:38:46+08:00

categories: [开发]
series: []
tags: [幂等性]
draft: true

cover:
    image: "028.webp"
    alt: "cover"
    relative: true
---

幂等性是指在重复执行同一个操作的情况下，其结果不会产生不同的影响。换句话说，无论执行多少次，最终结果都是相同的，不会发生变化。

在`HTTP/1.1`中，对幂等性进行了定义。它描述了一次和多次请求某一个资源对于资源本身应该具有同样的结果（网络超时等问题除外），即第一次请求的时候对资源产生了副作用，但是以后的多次请求都不会再对资源产生副作用。

防重设计和幂等性都是为了解决重复请求的问题，但它们的实现方式和目的不同。防重设计是为了避免重复请求对系统造成的负面影响，而幂等性则是为了保证请求的结果是一致的。

## 使用场景

大部分情况下不要求接口幂等性，但在遇到以下情况时需要实现接口幂等性：

1. 前端重复提交：用户连续点击提交按钮，导致提交重复的数据；
2. 接口重试：为了解决接口超时的问题，通常会引入重试机制，接口超时会导致多次请求；
3. 消息队列重复消费：消费者可能会读取到重复消息；

这类问题的多发场景：

- `insert`操作，多次请求会导致重复数据
- `update`操作， 如`update table set count = count + 1 `的操作，多次请求可能会导致错误

## 实现接口幂等性

### 

## 参考

[1] [高并发下如何保证接口的幂等性？](https://mp.weixin.qq.com/s/yhr7c2GwB8h7vw2cfUVUOQ) 

[2]

[3] [如何保证用户重试操作的幂等性](https://www.v2think.com/keep-user-interaction-idempotent) 
